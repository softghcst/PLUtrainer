<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>PLU Cashier Trainer ‚Äî Baked</title>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="theme-color" content="#0f1115">
<style>
  :root{
    --bg:#0f1115; --card:#161a22; --ink:#e7ecf3; --muted:#a8b3c7;
    --accent:#e6002d; --green:#29c759; --yellow:#ffd12f; --bad:#ff5d5d;
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--ink);font:16px/1.5 system-ui,Segoe UI,Roboto,Helvetica,Arial}
  header{padding:16px 20px;border-bottom:1px solid #202737;display:flex;gap:12px;align-items:center}
  header .logo{font-weight:800;letter-spacing:.2px}
  header .logo .hm{color:var(--accent)}
  header .meta{margin-left:auto;color:var(--muted);font-size:.9rem}
  main{max-width:1100px;margin:0 auto;padding:20px;display:grid;grid-template-columns:340px 1fr;gap:20px}
  .card{background:var(--card);border:1px solid #202737;border-radius:14px;box-shadow:0 4px 18px rgba(0,0,0,.25)}
  .left{display:flex;flex-direction:column;gap:16px}
  .section{padding:16px 16px 14px;border-bottom:1px dashed #23304a}
  .section:last-child{border-bottom:none}
  h2{margin:0 0 8px;font-size:1.1rem}
  h3{margin:0 0 8px;font-size:1.0rem;color:var(--muted)}
  .row{display:flex;gap:10px;align-items:center}
  .row.wrap{flex-wrap:wrap}
  .btn{appearance:none;border:none;background:#1d2433;color:#e7ecf3;border:1px solid #2a3345;padding:10px 12px;border-radius:12px;font-weight:700;cursor:pointer}
  .btn:hover{filter:brightness(1.08)}
  .btn.red{background:var(--accent);border-color:#ab001f}
  .btn.green{background:var(--green);border-color:#158a3d;color:#051b0c}
  .btn.yellow{background:var(--yellow);border-color:#b49300;color:#171200}
  .chip{display:inline-flex;align-items:center;padding:6px 10px;border-radius:999px;border:1px solid #2a3345;background:#111522;color:#cfd6e6}
  .pill{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border-radius:999px;background:#111522;border:1px solid #2a3345;color:#cfd6e6}
  .kbd{font-family:ui-monospace,monospace;background:#0b0f17;border:1px solid #2a3345;border-bottom-width:2px;border-radius:6px;padding:2px 6px}
  .table{width:100%;border-collapse:collapse;margin-top:8px}
  .table th,.table td{border-bottom:1px solid #22304a;padding:8px;text-align:left}
  .progress{height:8px;background:#0b0f17;border:1px solid #22304a;border-radius:999px;overflow:hidden}
  .progress #prog{background:linear-gradient(90deg,var(--green),#7aff9a,var(--accent),#ff6b6b);width:0%}
  .right .card{padding:16px}
  .prompt{font-size:1.2rem;margin-bottom:12px}
  .item-visual{display:flex;align-items:center;gap:12px;margin-bottom:8px}
  .item-visual .emoji{font-size:2rem}
  .code{font-family:ui-monospace,monospace}
  .muted{color:var(--muted)}
  .ok{color:#7aff9a} .bad{color:#ff5d5d}
  .small{font-size:.85rem}
  .toast{position:fixed;right:16px;bottom:16px;background:#111522;border:1px solid #2a3345;color:var(--ink);padding:12px 14px;border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,.35);opacity:0;transform:translateY(12px);transition:.25s}
  .toast.show{opacity:1;transform:translateY(0)}
  .keypad{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-top:8px}
  .keypad .key{display:flex;align-items:center;justify-content:center;padding:14px;background:#0d1016;border:1px solid #2a3345;border-radius:12px;font-weight:800;cursor:pointer}
  .hidden{display:none!important}
  .wrap { flex-wrap: wrap; }
</style>
</head>
<body>
<header>
  <div class="logo"><span class="hm">H</span>-Mart Cashier Trainer</div>
  <div class="meta small">Practice PLU codes anywhere ‚Ä¢ Offline ‚Ä¢ Saves progress</div>
</header>

<main>
  <aside class="left">
    <div class="card">
      <div class="section">
        <h2>Categories</h2>
        <div id="categories" class="row wrap"></div>
        <div class="row" style="margin-top:8px">
          <label class="pill"><input type="checkbox" id="mixMode" style="margin-right:6px"> Mix selected</label>
          <label class="pill"><input type="checkbox" id="strictLen" style="margin-right:6px"> Strict length (4 or 5)</label>
          <label class="pill"><input type="checkbox" id="includeOrganic" style="margin-right:6px" checked> Include Organics</label>
        </div>
      </div>
      <div class="section">
        <h2>Modes</h2>
        <div class="row">
          <button class="btn yellow" id="modeLearn">Learn (Flashcards)</button>
          <button class="btn red" id="modeQuiz">Quiz (Register)</button>
        </div>
      </div>
      <div class="section">
        <h2>Stats</h2>
        <div class="grid cols-2 small" style="display:grid;grid-template-columns:1fr 1fr;gap:8px">
          <div class="card" style="padding:10px">
            <div>Today Correct</div>
            <div id="statTodayOk" class="ok" style="font-weight:900;font-size:1.3rem">0</div>
          </div>
          <div class="card" style="padding:10px">
            <div>Today Mistakes</div>
            <div id="statTodayBad" class="bad" style="font-weight:900;font-size:1.3rem">0</div>
          </div>
        </div>
        <div class="progress" style="margin-top:10px"><div id="prog"></div></div>
        <div class="small muted" style="margin-top:6px">
          Tip: Use keyboard digits; <span class="kbd">Enter</span> submit, <span class="kbd">Backspace</span> delete one, <span class="kbd">Esc</span> clear.
        </div>
      </div>
    </div>

    <div class="card">
      <h2>Your List (Baked In)</h2>
      <table class="table small" id="dataTable">
        <thead><tr><th>Item</th><th>Code</th><th>Category</th><th>Notes</th></tr></thead>
        <tbody></tbody>
      </table>
    </div>
  </aside>

  <section class="right">
    <div class="card learn">
      <h2>Learn ‚Äî Flashcards</h2>
      <div id="learnWrap">
        <div class="prompt">Item: <b id="learnName"></b> <span class="muted">(<span id="learnCat"></span>)</span></div>
        <div class="item-visual"><div class="emoji" id="learnEmoji">üõí</div><div id="learnNotes" class="small muted"></div></div>
        <div class="row">
          <button class="btn" id="btnShowCode">Show Code</button>
          <div id="learnCode" class="code" style="font-size:1.2rem;margin-left:10px"></div>
        </div>
        <div class="row" style="margin-top:10px">
          <button class="btn green" id="btnEasy">Easy</button>
          <button class="btn" id="btnAgain">Again</button>
          <button class="btn" id="btnNext">Next</button>
        </div>
      </div>
    </div>

    <div class="card quiz hidden">
      <h2>Quiz ‚Äî Register</h2>
      <div class="prompt">Customer bought: <b id="qName"></b> <span class="muted">(<span id="qCat"></span>)</span></div>
      <div class="item-visual"><div class="emoji" id="qEmoji">üõí</div><div id="qNotes" class="small muted"></div></div>
      <div class="row"><div class="code" id="entry" style="font-size:1.4rem;min-width:120px"></div><div id="feedback" class="small"></div></div>
      <div class="keypad">
        <div class="key">1</div><div class="key">2</div><div class="key">3</div>
        <div class="key">4</div><div class="key">5</div><div class="key">6</div>
        <div class="key">7</div><div class="key">8</div><div class="key">9</div>
        <div class="key" id="kbClear">C</div><div class="key">0</div><div class="key" id="kbEnter">‚èé</div>
      </div>
      <div class="section" style="margin-top:12px;padding:0;border:none">
        <h3>Recent Answers</h3>
        <table class="table small" id="recent"><thead><tr><th>Item</th><th>Code</th><th>‚úì/‚úó</th></tr></thead><tbody></tbody></table>
      </div>
    </div>
  </section>
</main>

<div id="toast" class="toast">Saved!</div>

<!-- ‚úÖ BAKED MASTER LIST ‚Äî copied from your plu_master_backup.json exactly (Title-Case applied on load) -->
<script id="MASTER_JSON" type="application/json">[
  {"name":"Cosmic Crisp Apple","code":"2773","category":"Apple","notes":"","aliases":"","image":""},
  {"name":"Gala Apple","code":"2781","category":"Apple","notes":"","aliases":"","image":""},
  {"name":"Fuji Apple","code":"2782","category":"Apple","notes":"","aliases":"","image":""},
  {"name":"Fuji Apple (Organic)","code":"27829","category":"Apple","notes":"","aliases":"","image":""},
  {"name":"Red Delicious Apple","code":"2784","category":"Apple","notes":"","aliases":"","image":""},
  {"name":"Golden Delicious Apple","code":"2785","category":"Apple","notes":"","aliases":"","image":""},
  {"name":"Granny Smith Apple","code":"2788","category":"Apple","notes":"","aliases":"","image":""},
  {"name":"Envy Apple","code":"2792","category":"Apple","notes":"","aliases":"","image":""},
  {"name":"Honey Crisp Apple","code":"2794","category":"Apple","notes":"","aliases":"","image":""},
  {"name":"Pink Lady Apple","code":"2795","category":"Apple","notes":"","aliases":"","image":""},
  {"name":"Sugarbee Apple","code":"2807","category":"Apple","notes":"","aliases":"","image":""},

  {"name":"Asian Pear","code":"2725","category":"Pear","notes":"","aliases":"","image":""},
  {"name":"Yali Pear","code":"2726","category":"Pear","notes":"","aliases":"","image":""},
  {"name":"Fragrant Pear","code":"2727","category":"Pear","notes":"","aliases":"","image":""},
  {"name":"Korean Pear","code":"2728","category":"Pear","notes":"","aliases":"","image":""},
  {"name":"Korean Golden Pear","code":"2729","category":"Pear","notes":"","aliases":"","image":""},
  {"name":"Bosc Pear","code":"2731","category":"Pear","notes":"","aliases":"","image":""},
  {"name":"D‚ÄôAnjuor Pear","code":"2732","category":"Pear","notes":"","aliases":"","image":""},
  {"name":"Bartlett Pear","code":"2733","category":"Pear","notes":"","aliases":"","image":""},
  {"name":"Red D‚ÄôAnjour","code":"2741","category":"Pear","notes":"","aliases":"","image":""},
  {"name":"Sand Pear","code":"2744","category":"Pear","notes":"","aliases":"","image":""},
  {"name":"Apple Pear","code":"2746","category":"Pear","notes":"","aliases":"","image":""},

  {"name":"Korean Melon","code":"2670","category":"Melon","notes":"","aliases":"","image":""},
  {"name":"Hami Melon","code":"2671","category":"Melon","notes":"","aliases":"","image":""},
  {"name":"Tuscan Melon","code":"2687","category":"Melon","notes":"","aliases":"","image":""},
  {"name":"Cantaloupe","code":"2685","category":"Melon","notes":"","aliases":"","image":""},

  {"name":"Watermelon","code":"2811","category":"Watermelon","notes":"","aliases":"","image":""},

  {"name":"Fuyu Persimmon","code":"2651","category":"Persimmon","notes":"","aliases":"","image":""},
  {"name":"Quince","code":"2700","category":"Quince","notes":"","aliases":"","image":""},

  {"name":"Apple Banana","code":"2709","category":"Banana","notes":"","aliases":"","image":""},
  {"name":"Red Banana","code":"2710","category":"Banana","notes":"","aliases":"","image":""},
  {"name":"Yellow Banana","code":"2711","category":"Banana","notes":"","aliases":"","image":""},
  {"name":"Baby Banana","code":"2712","category":"Banana","notes":"","aliases":"","image":""},
  {"name":"Thai Banana","code":"2715","category":"Banana","notes":"","aliases":"","image":""},
  {"name":"Burro Banana","code":"2716","category":"Banana","notes":"","aliases":"","image":""},
  {"name":"Green Banana","code":"2718","category":"Banana","notes":"","aliases":"","image":""},

  {"name":"Green Plantain","code":"2719","category":"Plantain","notes":"","aliases":"","image":""},
  {"name":"Yellow Plantain","code":"2720","category":"Plantain","notes":"","aliases":"","image":""},

  {"name":"White Peach","code":"2760","category":"Peach","notes":"","aliases":"","image":""},
  {"name":"Yellow Peach","code":"2761","category":"Peach","notes":"","aliases":"","image":""},
  {"name":"White Donut Peach","code":"2763","category":"Peach","notes":"","aliases":"","image":""},
  {"name":"Yellow Nectarine","code":"2767","category":"Nectarine","notes":"","aliases":"","image":""},
  {"name":"White Nectarine","code":"2769","category":"Nectarine","notes":"","aliases":"","image":""},

  {"name":"Avocado Hass","code":"2839","category":"Avocado","notes":"","aliases":"","image":""},
  {"name":"Organic Avocado Hass","code":"28399","category":"Avocado","notes":"Organic ‚Üí 9 at end","aliases":"","image":""},

  {"name":"Cacao Fruit","code":"2845","category":"Tropical Fruit","notes":"","aliases":"","image":""},
  {"name":"Mango","code":"2847","category":"Mango","notes":"","aliases":"","image":""},
  {"name":"Green Mango","code":"2850","category":"Mango","notes":"","aliases":"","image":""},
  {"name":"Mango Box","code":"28473","category":"Mango","notes":"Box code","aliases":"","image":""},

  {"name":"White Coconut","code":"2857","category":"Coconut","notes":"","aliases":"","image":""},
  {"name":"Brown Coconut","code":"2858","category":"Coconut","notes":"","aliases":"","image":""},
  {"name":"Green Coconut","code":"2859","category":"Coconut","notes":"","aliases":"","image":""},

  {"name":"Papaya","code":"2862","category":"Papaya","notes":"","aliases":"","image":""},
  {"name":"Hawaiian Papaya","code":"2863","category":"Papaya","notes":"","aliases":"","image":""},
  {"name":"Green Papaya","code":"2864","category":"Papaya","notes":"","aliases":"","image":""},

  {"name":"Pomegranate","code":"2808","category":"Pomegranate","notes":"","aliases":"","image":""},

  {"name":"Fresh Durian","code":"2870","category":"Tropical Fruit","notes":"","aliases":"","image":""},
  {"name":"Frozen Durian","code":"28708","category":"Tropical Fruit","notes":"","aliases":"","image":""},
  {"name":"Sapote (Mamey)","code":"2872","category":"Tropical Fruit","notes":"","aliases":"","image":""},
  {"name":"Dragon Fruit White Flesh","code":"2874","category":"Tropical Fruit","notes":"","aliases":"","image":""},
  {"name":"Longan","code":"2875","category":"Tropical Fruit","notes":"","aliases":"","image":""},
  {"name":"Soursop","code":"2876","category":"Tropical Fruit","notes":"","aliases":"","image":""},
  {"name":"Rambutan","code":"2877","category":"Tropical Fruit","notes":"","aliases":"","image":""},
  {"name":"Guava","code":"2878","category":"Tropical Fruit","notes":"","aliases":"","image":""},
  {"name":"Cherimoya","code":"2879","category":"Tropical Fruit","notes":"","aliases":"","image":""},
  {"name":"Mangosteen","code":"2880","category":"Tropical Fruit","notes":"","aliases":"","image":""},
  {"name":"Breadfruit","code":"2881","category":"Tropical Fruit","notes":"","aliases":"","image":""},
  {"name":"Yellow Dragon Fruit","code":"2883","category":"Tropical Fruit","notes":"","aliases":"","image":""},

  {"name":"Pineapple","code":"2868","category":"Pineapple","notes":"","aliases":"","image":""},

  {"name":"Sweet Lime","code":"2886","category":"Citrus","notes":"","aliases":"","image":""},
  {"name":"Lime","code":"2887","category":"Citrus","notes":"","aliases":"","image":""},
  {"name":"Lemon","code":"2888","category":"Citrus","notes":"","aliases":"","image":""},

  {"name":"Korean Hallabong","code":"2884","category":"Orange","notes":"","aliases":"","image":""},
  {"name":"Navel Orange","code":"2889","category":"Orange","notes":"","aliases":"","image":""},
  {"name":"Cara Cara Orange","code":"2896","category":"Orange","notes":"","aliases":"","image":""},
  {"name":"Minneola Orange","code":"2898","category":"Orange","notes":"","aliases":"","image":""},
  {"name":"Blood Orange","code":"2899","category":"Orange","notes":"","aliases":"","image":""},
  {"name":"Orri Mandarin","code":"2900","category":"Mandarin","notes":"","aliases":"","image":""},
  {"name":"Sour Orange","code":"2912","category":"Orange","notes":"","aliases":"","image":""},

  {"name":"Yellow Plum","code":"2919","category":"Plum","notes":"","aliases":"","image":""},
  {"name":"Red Plum","code":"2921","category":"Plum","notes":"","aliases":"","image":""},
  {"name":"Dinosaur Plum","code":"2922","category":"Plum","notes":"","aliases":"","image":""},

  {"name":"Pink Grapefruit","code":"2948","category":"Grapefruit","notes":"","aliases":"","image":""},

  {"name":"Florida Pomelo","code":"2953","category":"Pomelo","notes":"","aliases":"","image":""},
  {"name":"Chinese Pomelo","code":"2954","category":"Pomelo","notes":"","aliases":"","image":""},
  {"name":"Pomelo","code":"2955","category":"Pomelo","notes":"","aliases":"","image":""},

  {"name":"Cotton Candy Grape","code":"2969","category":"Grape","notes":"","aliases":"","image":""},
  {"name":"Green Seedless Grape","code":"2971","category":"Grape","notes":"","aliases":"","image":""},
  {"name":"Red Seedless Grape","code":"2972","category":"Grape","notes":"","aliases":"","image":""},

  {"name":"Plain Parsley","code":"2349","category":"Herbs","notes":"","aliases":"","image":""},
  {"name":"Cilantro","code":"2350","category":"Herbs","notes":"","aliases":"","image":""},
  {"name":"Curly Parsley","code":"2351","category":"Herbs","notes":"","aliases":"","image":""},

  {"name":"Gray Squash","code":"2411","category":"Squash","notes":"","aliases":"","image":""},
  {"name":"Korean Squash","code":"2412","category":"Squash","notes":"","aliases":"","image":""},
  {"name":"Kabocha","code":"2418","category":"Squash","notes":"","aliases":"","image":""},
  {"name":"Calabaza","code":"2419","category":"Squash","notes":"","aliases":"","image":""},
  {"name":"Spaghetti Squash","code":"2421","category":"Squash","notes":"","aliases":"","image":""},
  {"name":"Butternut Squash","code":"2423","category":"Squash","notes":"","aliases":"","image":""},
  {"name":"Acorn Squash","code":"2424","category":"Squash","notes":"","aliases":"","image":""},

  {"name":"Watercress","code":"2455","category":"Leafy Greens","notes":"","aliases":"","image":""},
  {"name":"Turnip Green","code":"2456","category":"Leafy Greens","notes":"","aliases":"","image":""},
  {"name":"Leek","code":"2458","category":"Leafy Greens","notes":"","aliases":"","image":""},
  {"name":"Dill","code":"2464","category":"Herbs","notes":"","aliases":"","image":""},
  {"name":"Radicchio","code":"2509","category":"Leafy Greens","notes":"","aliases":"","image":""},
  {"name":"Red Beet Bunch","code":"2472","category":"Root Vegetable","notes":"","aliases":"","image":""},
  {"name":"Red Beet","code":"2473","category":"Root Vegetable","notes":"","aliases":"","image":""},

  {"name":"Kale","code":"2490","category":"Leafy Greens","notes":"","aliases":"","image":""},
  {"name":"Curly Kale","code":"2491","category":"Leafy Greens","notes":"","aliases":"","image":""},
  {"name":"White Turnip","code":"2495","category":"Root Vegetable","notes":"","aliases":"","image":""},
  {"name":"Green Onion","code":"2498","category":"Onion","notes":"","aliases":"","image":""},

  {"name":"White Garlic","code":"2525","category":"Garlic","notes":"","aliases":"","image":""},
  {"name":"Ginger","code":"2530","category":"Root Vegetable","notes":"","aliases":"","image":""},

  {"name":"White Onion","code":"2538","category":"Onion","notes":"","aliases":"","image":""},
  {"name":"Red Onion","code":"2539","category":"Onion","notes":"","aliases":"","image":""},
  {"name":"Yellow Onion","code":"2540","category":"Onion","notes":"","aliases":"","image":""},
  {"name":"Shallot Onion","code":"2547","category":"Onion","notes":"","aliases":"","image":""},

  {"name":"Potato","code":"2557","category":"Potato","notes":"","aliases":"","image":""},
  {"name":"Red Potato","code":"2558","category":"Potato","notes":"","aliases":"","image":""},
  {"name":"White Potato","code":"2559","category":"Potato","notes":"","aliases":"","image":""},

  {"name":"American Yam","code":"2560","category":"Yam","notes":"","aliases":"","image":""},
  {"name":"Korean Sweet Potato","code":"2565","category":"Yam","notes":"","aliases":"","image":""},
  {"name":"Korean Sweet Potato Box","code":"25656","category":"Yam","notes":"Box code","aliases":"","image":""},

  {"name":"Yucca","code":"2581","category":"Root Vegetable","notes":"","aliases":"","image":""},
  {"name":"Jicama","code":"2582","category":"Root Vegetable","notes":"","aliases":"","image":""},
  {"name":"Yellow Yam","code":"2584","category":"Yam","notes":"","aliases":"","image":""},
  {"name":"White Yam","code":"2585","category":"Yam","notes":"","aliases":"","image":""},
  {"name":"Batata","code":"2586","category":"Yam","notes":"","aliases":"","image":""},
  {"name":"Yautia","code":"2587","category":"Yam","notes":"","aliases":"","image":""},
  {"name":"Yampi","code":"2590","category":"Yam","notes":"","aliases":"","image":""},
  {"name":"Hawaiian Purple Yam","code":"2591","category":"Yam","notes":"","aliases":"","image":""},

  {"name":"Small Taro (Eddo)","code":"2593","category":"Root Vegetable","notes":"","aliases":"","image":""},
  {"name":"Big Taro (Malanga)","code":"2594","category":"Root Vegetable","notes":"","aliases":"","image":""},
  {"name":"Name Yam","code":"2595","category":"Yam","notes":"","aliases":"","image":""},
  {"name":"Malanga Blanca","code":"2596","category":"Root Vegetable","notes":"","aliases":"","image":""},

  {"name":"Pandan Leaf","code":"2410","category":"Herbs / Aromatics","notes":"","aliases":"","image":""},

  {"name":"Banana Flower","code":"2713","category":"Flowers / Special Veggies","notes":"","aliases":"","image":""},
  {"name":"Okra","code":"2075","category":"Pods","notes":"","aliases":"","image":""},
  {"name":"Chinese Okra","code":"2076","category":"Pods","notes":"","aliases":"","image":""},

  {"name":"Holland Red Pepper","code":"2122","category":"Pepper","notes":"","aliases":"","image":""},
  {"name":"Holland Yellow Pepper","code":"2123","category":"Pepper","notes":"","aliases":"","image":""},
  {"name":"Holland Green Pepper","code":"2124","category":"Pepper","notes":"","aliases":"","image":""},
  {"name":"Holland Orange Pepper","code":"2125","category":"Pepper","notes":"","aliases":"","image":""},

  {"name":"Carrot","code":"2163","category":"Root Vegetable","notes":"","aliases":"","image":""},
  {"name":"Jujube","code":"2173","category":"Fruit","notes":"","aliases":"","image":""},
  {"name":"Korean Radish","code":"2175","category":"Root Vegetable","notes":"","aliases":"","image":""},
  {"name":"Daikon Radish (Chinese)","code":"2179","category":"Root Vegetable","notes":"","aliases":"","image":""},

  {"name":"Napa Cabbage","code":"2195","category":"Cabbage","notes":"","aliases":"","image":""},
  {"name":"Chinese Chives","code":"2221","category":"Herbs / Aromatics","notes":"","aliases":"","image":""},

  {"name":"Broccoli","code":"2231","category":"Brassica","notes":"","aliases":"","image":""},
  {"name":"White Cauliflower","code":"2234","category":"Brassica","notes":"","aliases":"","image":""},
  {"name":"Purple Cauliflower","code":"2235","category":"Brassica","notes":"","aliases":"","image":""},
  {"name":"Chinese Cauliflower","code":"2239","category":"Brassica","notes":"","aliases":"","image":""},

  {"name":"Red Leaf Lettuce","code":"2242","category":"Lettuce","notes":"","aliases":"","image":""},
  {"name":"Green Leaf Lettuce","code":"2243","category":"Lettuce","notes":"","aliases":"","image":""},
  {"name":"Romaine Lettuce","code":"2245","category":"Lettuce","notes":"","aliases":"","image":""},

  {"name":"Celery","code":"2252","category":"Stalks","notes":"","aliases":"","image":""},

  {"name":"Asparagus","code":"2262","category":"Asparagus","notes":"","aliases":"","image":""},
  {"name":"White Asparagus","code":"2263","category":"Asparagus","notes":"","aliases":"","image":""},
  {"name":"Purple Asparagus","code":"2264","category":"Asparagus","notes":"","aliases":"","image":""},

  {"name":"Green Cabbage","code":"2268","category":"Cabbage","notes":"","aliases":"","image":""},
  {"name":"White Cabbage","code":"2269","category":"Cabbage","notes":"","aliases":"","image":""},
  {"name":"Savoy Cabbage","code":"2271","category":"Cabbage","notes":"","aliases":"","image":""},

  {"name":"Yellow Corn","code":"2285","category":"Corn","notes":"","aliases":"","image":""},
  {"name":"Chayote","code":"2294","category":"Chayote","notes":"","aliases":"","image":""},

  {"name":"Green Bean","code":"2308","category":"Beans","notes":"","aliases":"","image":""},
  {"name":"Flat Bean","code":"2310","category":"Beans","notes":"","aliases":"","image":""},

  {"name":"Tomatoes","code":"2325","category":"Tomato","notes":"","aliases":"","image":""},
  {"name":"Plum Tomatoes","code":"2326","category":"Tomato","notes":"","aliases":"","image":""},
  {"name":"Stem Tomatoes","code":"2327","category":"Tomato","notes":"","aliases":"","image":""},
  {"name":"Beef Tomato","code":"2328","category":"Tomato","notes":"","aliases":"","image":""},

  {"name":"Parsnip Root","code":"2346","category":"Root Vegetable","notes":"","aliases":"","image":""},

  {"name":"Stem Tomato Box","code":"23273","category":"Tomato","notes":"Box code","aliases":"","image":""}
]</script>

<script>
  // --- Tiny helpers
  const $ = s=>document.querySelector(s);
  const $$ = s=>[...document.querySelectorAll(s)];
  const store = {
    save(k,v){ localStorage.setItem(k, JSON.stringify(v)); },
    get(k,f){ try{ return JSON.parse(localStorage.getItem(k)) ?? f }catch(_){ return f } },
    del(k){ localStorage.removeItem(k) },
  };
  const EMOJI = {
    "Apple":"üçé","Pear":"üçê","Tomato":"üçÖ","Avocado":"ü•ë","Banana":"üçå","Onion":"üßÖ",
    "Potato":"ü•î","Pepper":"ü´ë","Berries":"ü´ê","Citrus":"üçä","Melon":"üçâ","Watermelon":"üçâ","Papaya":"ü•≠",
    "Leafy Greens":"ü•¨","Herbs":"üåø","Mushroom":"üçÑ","Root Vegetable":"ü•ï","Grape":"üçá","Orange":"üçä",
    "Mandarin":"üçä","Plum":"üçë","Grapefruit":"üçä","Pomelo":"üçä","Mango":"ü•≠","Coconut":"ü••",
    "Pineapple":"üçç","Tropical Fruit":"ü•≠","Asparagus":"ü•¨","Cabbage":"ü•¨","Lettuce":"ü•¨","Beans":"ü´ò",
    "Corn":"üåΩ","Garlic":"üßÑ","Yam":"üç†","Pomegranate":"üçé","Chayote":"ü•í","Flowers / Special Veggies":"üå∏",
    "Default":"üõí"
  };
  const pickEmoji = cat => EMOJI[cat] || EMOJI.Default;
  const titleCase = s => String(s||"").toLowerCase().replace(/\b([a-z])/g, m => m.toUpperCase());

  // --- State
  let DATA = [];
  let FILTER = { cats: new Set(), mix:false, strict:false, includeOrganic:true };
  let MODE = "learn";
  let QUEUE = [];
  let CURRENT = null;
  let entryBuf = "";
  let today = store.get("plu:today", {date:new Date().toDateString(), ok:0, bad:0});
  function resetTodayIfNeeded(){
    const d = new Date().toDateString();
    if(today.date !== d){ today = {date:d, ok:0, bad:0}; store.save("plu:today", today) }
  }
  resetTodayIfNeeded();

  // --- Renderers
  function updateStats(){
    $("#statTodayOk").textContent = today.ok;
    $("#statTodayBad").textContent = today.bad;
    const total = today.ok + today.bad;
    $("#prog").style.width = total ? Math.min(100, (today.ok/(total))*100) + "%" : "0%";
  }
  function renderTable(){
    const tb = $("#dataTable tbody");
    tb.innerHTML = "";
    for(const r of DATA){
      const tr = document.createElement("tr");
      tr.innerHTML = `<td>${r.name}</td><td class="code">${r.code}</td><td>${r.category}</td><td class="muted">${r.notes||""}</td>`;
      tb.appendChild(tr);
    }
  }
  function computeCategories(){
    return [...new Set(DATA.map(d=>d.category))].sort();
  }
  function renderCategories(){
    const cats = computeCategories();
    const wrap = $("#categories"); wrap.innerHTML = "";
    for(const c of cats){
      const el = document.createElement("button");
      el.className = "btn";
      el.textContent = c;
      el.onclick = ()=>{
        if(FILTER.cats.has(c)) FILTER.cats.delete(c); else FILTER.cats.add(c);
        el.classList.toggle("green");
        buildQueue();
      };
      wrap.appendChild(el);
    }
  }

  // --- Learn / Quiz queue
  function shuffle(arr){ for(let i=arr.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [arr[i],arr[j]]=[arr[j],arr[i]] } return arr }
  function buildQueue(){
    const list = DATA.filter(d =>
      (FILTER.cats.size===0 || FILTER.cats.has(d.category)) &&
      (FILTER.includeOrganic || !/^\s*9\d{4}\s*$/.test(d.code))
    );
    QUEUE = FILTER.mix ? shuffle([...list]) : [...list].sort((a,b)=>a.name.localeCompare(b.name));
    nextItem();
  }
  function showLearn(){ $(".learn").classList.remove("hidden"); $(".quiz").classList.add("hidden"); nextItem(); }
  function showQuiz(){  $(".learn").classList.add("hidden");  $(".quiz").classList.remove("hidden"); nextItem(); }
  function nextItem(){
    if(QUEUE.length===0){ $("#learnName").textContent = ""; $("#qName").textContent=""; return }
    CURRENT = QUEUE[0];
    if(MODE==="learn"){
      $("#learnName").textContent = CURRENT.name;
      $("#learnCat").textContent = CURRENT.category;
      $("#learnNotes").textContent = CURRENT.notes || "";
      $("#learnCode").textContent = "";
      $("#learnEmoji").textContent = pickEmoji(CURRENT.category);
    }else{
      $("#qName").textContent = CURRENT.name;
      $("#qCat").textContent = CURRENT.category;
      $("#qNotes").textContent = CURRENT.notes || "";
      $("#qEmoji").textContent = pickEmoji(CURRENT.category);
      entryBuf = ""; $("#entry").textContent = ""; $("#feedback").innerHTML = "";
    }
  }
  function againCard(){ if(QUEUE.length>1){ const it=QUEUE.shift(); QUEUE.splice(2,0,it); } nextItem(); }
  function easyCard(){ if(QUEUE.length>0){ QUEUE.shift(); } nextItem(); }

  // --- Quiz input
  function pushRecent(item, correct){
    const tb = $("#recent tbody");
    const tr = document.createElement("tr");
    tr.innerHTML = `<td>${item.name}</td><td class="code">${item.code}</td><td class="${correct?'ok':'bad'}">${correct?'‚úî':'‚úò'}</td>`;
    tb.prepend(tr);
    while(tb.children.length>7) tb.removeChild(tb.lastChild);
  }
  function submitEntry(){
    const wantLen = CURRENT.code.length;
    const given = entryBuf.trim();
    if(!given) return;
    if($("#strictLen").checked && given.length!==wantLen){
      $("#feedback").innerHTML = `<span class="bad">Length mismatch.</span> Expect ${wantLen} digits.`;
      return;
    }
    const ok = given === CURRENT.code;
    if(ok){
      $("#feedback").innerHTML = `<span class="ok">Correct!</span> ${CURRENT.name} is <span class="code">${CURRENT.code}</span>`;
      today.ok++; store.save("plu:today", today);
      pushRecent(CURRENT,true);
      if(QUEUE.length>0){ QUEUE.shift(); }
    }else{
      $("#feedback").innerHTML = `<span class="bad">Oops.</span> Correct code: <span class="code">${CURRENT.code}</span>`;
      today.bad++; store.save("plu:today", today);
      pushRecent(CURRENT,false);
      if(QUEUE.length>1){ const miss=QUEUE.shift(); QUEUE.splice(3,0,miss); }
    }
    updateStats(); nextItem();
  }
  function addDigit(d){ entryBuf += d; $("#entry").textContent = entryBuf; }
  function backspace(){ entryBuf = entryBuf.slice(0,-1); $("#entry").textContent = entryBuf; }
  function clearEntry(){ entryBuf = ""; $("#entry").textContent = ""; }

  // keypad + keyboard
  window.addEventListener("keydown", (e)=>{
    if(/^\d$/.test(e.key)) addDigit(e.key);
    else if(e.key==="Enter") submitEntry();
    else if(e.key==="Backspace"){ e.preventDefault(); backspace(); }
    else if(e.key==="Escape") clearEntry();
  });
  document.addEventListener("click", (e)=>{
    if(e.target.classList.contains("key")){
      const v = e.target.textContent.trim();
      if(/^\d$/.test(v)) addDigit(v);
    }
    if(e.target.id==="kbEnter") submitEntry();
    if(e.target.id==="kbClear") clearEntry();
    if(e.target.id==="modeLearn"){ MODE="learn"; showLearn(); }
    if(e.target.id==="modeQuiz"){  MODE="quiz";  showQuiz();  }
    if(e.target.id==="btnShowCode"){ $("#learnCode").textContent = CURRENT? CURRENT.code : ""; }
    if(e.target.id==="btnNext") nextItem();
    if(e.target.id==="btnAgain") againCard();
    if(e.target.id==="btnEasy") easyCard();
  });
  $("#mixMode").onchange = e=>{ FILTER.mix = e.target.checked; buildQueue() };
  $("#strictLen").onchange = e=>{ FILTER.strict = e.target.checked };
  $("#includeOrganic").onchange = e=>{ FILTER.includeOrganic = e.target.checked; buildQueue() };

  // --- Boot: read baked JSON and normalize
  (function boot(){
    try{
      const raw = JSON.parse(document.getElementById("MASTER_JSON").textContent);
      DATA = raw.map(r => ({
        name: titleCase(r.name||""),
        code: String(r.code||"").trim(),
        category: titleCase(r.category||"Other"),
        notes: (r.notes||""),
        aliases: Array.isArray(r.aliases) ? r.aliases.map(a=>titleCase(a)) :
                 String(r.aliases||"").split("|").map(a=>titleCase(a.trim())).filter(Boolean),
        image: r.image||""
      }));
    }catch(e){
      alert("Problem reading baked PLU JSON. Double-check the MASTER_JSON block.");
      console.error(e);
      DATA = [];
    }
    renderTable(); renderCategories(); buildQueue(); updateStats();
  })();
</script>
</body>
</html>
